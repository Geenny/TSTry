{"code":"!function(t){var e={};function i(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:s})},i.r=function(t){Object.defineProperty(t,\"__esModule\",{value:!0})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,\"a\",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p=\"\",i(i.s=0)}([function(t,e,i){\"use strict\";i.r(e);class s{constructor(){this._dispatcher=[]}dispatchEvent(t){for(let e=0;e<this._dispatcher.length;e++){let i=this._dispatcher[e];i.type==t.type&&i.handler(t)}}addEventListener(t,e,i=!1,s=0){t&&e&&this._dispatcher.push(new n(t,e,i,s))}removeEventListener(t,e){for(let i=this._dispatcher.length-1;i>-1;i--){let s=this._dispatcher[i];s.type!=t&&s.handler!=e||this._dispatcher.splice(i,1)}}removeEventListeners(){for(;this._dispatcher.length;){let t=this._dispatcher[this._dispatcher.length-1];this.removeEventListener(t.type,t.handler)}}}class n{constructor(t,e,i=!1,s=0){this.type=t,this.handler=e,this.useCapture=i,this.priority=s}}class r{constructor(t,e=!1,i=!1){this.type=t,this.bubbles=e,this.cancelable=i}}class a extends r{static get INIT(){return\"dependencyInit\"}static get START(){return\"dependencyStart\"}static get COMPLETE(){return\"dependencyComplete\"}static get CHANGE(){return\"dependencyChange\"}static get STEP(){return\"dependencyStep\"}static get ERROR(){return\"dependencyError\"}static get DESTROY(){return\"dependencyError\"}constructor(t,e){super(t,!1,!1),this.dependency=e}}class h extends r{static get INIT(){return\"dependencyManagerInit\"}static get COMPLETE(){return\"dependencyManagerComplete\"}static get DEPENDENCY_COMPLETE(){return\"dependencyManagerDependencyComplete\"}static get DEPENDENCY_CHANGE(){return\"dependencyManagerDependencyChange\"}static get DEPENDENCY_ERROR(){return\"dependencyManagerDependencyError\"}static get DEPENDENCY_DESTROY(){return\"dependencyManagerDependencyDestroy\"}constructor(t,e=null,i=null){super(t,!1,!1),this.manager=e,this.dependency=i}}var o,d,l;!function(t){t[t.NONE=0]=\"NONE\",t[t.STARTED=1]=\"STARTED\",t[t.PROCESS=2]=\"PROCESS\",t[t.COMPLETE=3]=\"COMPLETE\",t[t.CHANGE=4]=\"CHANGE\",t[t.DESTROY=5]=\"DESTROY\",t[t.ERROR=6]=\"ERROR\"}(o||(o={}));class c extends s{constructor(t,e=[]){super(),this._list=[],this._manager=t,this._list=e}get inited(){return this._inited}get ID(){return this._ID}get name(){return this._name}get description(){return this._description}get state(){return this._state}set state(t){this._state=t}get list(){return this._list}get enable(){return this._enable}set enable(t){this._enable=t}get complete(){return this._complete}get process(){return this._process}get errorMessage(){return this._errorMessage}get manager(){return this._manager}init(){this.dispatchEvent(new a(a.INIT,this))}destroy(){this.state=o.DESTROY,this._enable=!1,this.dispatchEvent(new a(a.DESTROY,this))}addDependency(t){if(!t)return!1;for(let e=0;e<t.length;e++){let i=t[e],s=i instanceof c?i.ID:i;-1==this.list.indexOf(s)&&this.list.push(s)}return this.list.length>0}reset(){this._complete=!1}start(){this._process=!0,this.state=o.STARTED,this.dispatchEvent(new a(a.START,this))}step(){this.state=o.PROCESS,this.dispatchEvent(new a(a.STEP,this))}finish(){this._process=!1,this._complete=!0,this.state=o.COMPLETE,this.dispatchEvent(new a(a.COMPLETE,this))}error(){this._process=!1,this.state=o.ERROR,this.dispatchEvent(new a(a.ERROR,this))}change(){this._process=!0,this.state=o.CHANGE,this.dispatchEvent(new a(a.CHANGE,this))}}class u extends s{constructor(t=null){super(),this._listOfListeners=[],this._changeDependencyList=[],this._list=[],this.initDependencyList(t)}init(){this.started||(this.started=!0,this.reinit())}destroy(){for(let t=0;t<this.length;t++){let t=this._list.shift();t&&t.destroy()}}get inited(){return this._inited}get enable(){return this._enable}set enable(t){this._enable=t}get length(){return this._list.length}initDependencyList(t=null){this.clearList();for(let e=0;e<t.length;e++){let i=t[e];this.dependencyAdd(i)}}clearList(){for(;this.length;){let t=this._list.shift();this.dependencyDestroy(t)}}dependencyDestroy(t){t&&(t.destroy(),t=null)}dependencyAdd(t){return t instanceof c?this.dependencyInList(t)?t:(this._list.push(t),this.inited&&this.dependenceChange(t),t):null}dependencyRemove(t){return this.dependencyInList(t)?(this._list.slice(this.dependencyIndex(t),1),t):null}dependencyInList(t){return-1!=this.dependencyIndex(t)}dependencyIndex(t){return this._list.indexOf(t)}dependencyByIndexGet(t){return t<0||t>=this.length?null:this._list[t]}dependencyByIDGet(t){for(let e=0;e<this.length;e++){let i=this._list[e];if(i.ID==t)return i}return null}dependencyListenersAdd(t){return-1==this._listOfListeners.indexOf(t)&&(t.addEventListener(a.INIT,this.onDependencyInit),t.addEventListener(a.START,this.onDependencyStart),t.addEventListener(a.STEP,this.onDependencyStep),t.addEventListener(a.COMPLETE,this.onDependencyComplete),t.addEventListener(a.CHANGE,this.onDependencyChange),t.addEventListener(a.ERROR,this.onDependencyError),t.addEventListener(a.DESTROY,this.onDependencyDestroy),!0)}dependencyListenersRemove(t){if(!t)return!1;t.removeEventListener(a.INIT,this.onDependencyInit),t.removeEventListener(a.START,this.onDependencyStart),t.removeEventListener(a.STEP,this.onDependencyStep),t.removeEventListener(a.COMPLETE,this.onDependencyComplete),t.removeEventListener(a.CHANGE,this.onDependencyChange),t.removeEventListener(a.ERROR,this.onDependencyError),t.removeEventListener(a.DESTROY,this.onDependencyDestroy);let e=this._listOfListeners.indexOf(t);return-1==e&&this._listOfListeners.splice(e,1),!0}reinit(){this.enable&&this.started&&(this.dependenceListAddListeners(),this.dependenceProcess())}dependenceListAddListeners(){for(let t=0;t<this.length;t++){let e=this.dependencyByIndexGet(t);e&&this.dependencyListenersAdd(e)}}dependenceListRemoveListeners(){for(let t=0;t<this.length;t++){let e=this.dependencyByIndexGet(t);e&&this.dependencyListenersRemove(e)}}dependenceProcess(){this.dependencyProcessStart(),this.dependencyProcessCheckReady()}dependencyProcessStart(){let t=[];for(let e=0;e<this.length;e++){let i=this.dependencyByIndexGet(e);this.isReadyForStart(i)&&(this.childDependenciesReady(i)&&t.push(i))}for(let e=0;e<t.length;e++)t[e].start()}dependencyProcessCheckReady(){return!!this.isDependencyProcessComplete&&(this._inited=!0,this.dispatchEvent(new h(h.COMPLETE,this)),!0)}get isDependencyProcessComplete(){let t=0;for(let e=0;e<this.length;e++){this.dependencyByIndexGet(e).complete&&t++}return t>=this.length}isReadyForStart(t){return t&&t.enable&&!t.process&&t.complete}childDependenciesReady(t){let e=0;for(let i=0;i<this.length;i++){let s=this.dependencyByIndexGet(i);s!=t&&(s.complete||-1!=t.list.indexOf(s.ID)&&e++)}return e>=t.list.length}dependenceChange(t){this.dependencyInList(t)||this.dependencyInChangeList(t)||(this._changeDependencyList.push(t),this.inited&&this.dependenceDownChange())}dependencyInChangeList(t){return-1!=this._changeDependencyList.indexOf(t)}dependenceDownChange(){for(this._inited=!1;;){let t=0;for(let e=0;e<this._changeDependencyList.length;e++){let i=this._changeDependencyList[e];for(let e=0;e<this._list.length;e++){let s=this._list[e];-1!=i.list.indexOf(s.ID)&&(-1!=this._changeDependencyList.indexOf(s)&&(this._changeDependencyList.push(s),t++))}}if(0==t)break}for(let t=0;t<this._changeDependencyList.length;t++){let e=this._changeDependencyList[t];e&&(this.dependencyInList(e)||this._list.push(e),e.reset())}this.dependenceProcess()}onDependencyInit(t){}onDependencyStart(t){}onDependencyStep(t){}onDependencyComplete(t){let e=t.dependency,i=e.manager;i.dispatchEvent(new h(h.DEPENDENCY_COMPLETE,i,e)),i.dependenceProcess()}onDependencyChange(t){let e=t.dependency,i=e.manager;i.dispatchEvent(new h(h.DEPENDENCY_CHANGE,i,e)),i.dependenceChange(e)}onDependencyError(t){let e=t.dependency,i=e.manager;i.dispatchEvent(new h(h.DEPENDENCY_ERROR,i,e))}onDependencyDestroy(t){let e=t.dependency,i=e.manager;i.dispatchEvent(new h(h.DEPENDENCY_DESTROY,i,e))}}class p extends r{static get ERROR(){return\"moduleError\"}static get DESTROY(){return\"moduleDestroy\"}static get COMPLETE(){return\"moduleComplete\"}static get CHANGE(){return\"moduleChange\"}constructor(t,e){super(t,!1,!1),this.module=e}}class E extends r{static get INIT(){return\"modulesInit\"}static get COMPLETE(){return\"modulesComplete\"}constructor(t,e,i=null){super(t,!1,!1),this.modules=e,this.module=i}}class g extends s{constructor(){super(),this._enable=!0,this.dependencyListByNames=[]}init(){this.initDependencyManager()}destroy(){}get enable(){return this._enable}set enable(t){this._enable=t}initDependencyManager(){this.manager=new u(this.getModules()),this.addEventListener(h.DEPENDENCY_CHANGE,this.onModuleChange),this.addEventListener(h.DEPENDENCY_COMPLETE,this.onModuleComplete),this.addEventListener(h.DEPENDENCY_DESTROY,this.onModuleDestroy),this.addEventListener(h.DEPENDENCY_ERROR,this.onModuleError),this.addEventListener(h.INIT,this.onModulesInit),this.addEventListener(h.COMPLETE,this.onModulesComplete),this.manager.init()}onModuleChange(t){this.dispatchEvent(new p(p.CHANGE,t.dependency))}onModuleComplete(t){this.dispatchEvent(new p(p.COMPLETE,t.dependency))}onModuleDestroy(t){this.dispatchEvent(new p(p.DESTROY,t.dependency))}onModuleError(t){this.dispatchEvent(new p(p.ERROR,t.dependency))}onModulesInit(t){this.dispatchEvent(new E(E.INIT,this,t.dependency))}onModulesComplete(t){this.dispatchEvent(new E(E.COMPLETE,this,t.dependency))}getModules(){let t=[];for(let e=0;e<this.dependencyListByNames.length;e++){let i=this.getDependencyByName(this.dependencyListByNames[e]);i&&t.push(i)}return t}getDependencyByName(t){return null}}class v extends s{constructor(t,e=null){super(),this._enable=!0,this.options={},this.initApplication(t),this.initOptions(e)}initApplication(t){t&&(this.application=t)}initOptions(t){t&&(this.options=t)}init(){}get enable(){return this._enable}set enable(t){this._enable=t}get inited(){return this._inited}set inited(t){this._inited=t}get application(){return this._application}set application(t){this._application=t}get target(){return this._target}set target(t){this._target=t}}class m extends r{static get APPLICATION_KEYBOARD_KEYDOWN(){return\"applicationKeyboardKeydown\"}static get APPLICATION_KEYBOARD_KEYUP(){return\"applicationKeyboardKeyup\"}static get APPLICATION_RESIZE(){return\"applicationResize\"}static get APPLICATION_FOCUS(){return\"applicationFocus\"}static get APPLICATION_BLUR(){return\"applicationBlur\"}static get APPLICATION_SCREEN_FULL(){return\"applicationScreenFull\"}static get APPLICATION_SCREEN_NORMAL(){return\"applicationScreenNormal\"}static get APPLICATION_SERVICE_STORAGE_STORE(){return\"applicationServiceStorageStore\"}static get APPLICATION_SERVICE_STORAGE_READ(){return\"applicationServiceStorageRead\"}static get APPLICATION_DEVICE_ORIENTATION_CHANGE(){return\"applicationDeviceOrientationChange\"}static get APPLICATION_DEVICE_ORIENTATION(){return\"applicationDeviceOrientation\"}static get APPLICATION_DEVICE_MOTION(){return\"applicationDeviceMotion\"}constructor(t,e){super(t,!1,!1),this.data=e}}class y{constructor(t){this.alt=!1,this.ctrl=!1,this.charCode=0,this.keyCode=0,this.parse(t)}parse(t){t&&(this.event=t,this.type=t.type,this.alt=t.altKey||!1,this.ctrl=t.ctrlKey||!1,this.charCode=t.charCode||0,this.keyCode=t.keyCode||0,this.key=t.key)}}class O extends v{static get DOM_EVENT_KEYDOWN(){return\"keydown\"}static get DOM_EVENT_KEYUP(){return\"keyup\"}constructor(t){super(t),this.init()}get container(){return this.application.container}init(){this.initListeners(),O.instance=this,this.target=this.application,this.inited=!0}initListeners(){this.removeListeners(),this.addListeners()}addListeners(){this.container&&!this.listeners&&(this.listeners=!0,this.container.addEventListener(O.DOM_EVENT_KEYDOWN,this.onKeyDown),this.container.addEventListener(O.DOM_EVENT_KEYUP,this.onKeyUp))}removeListeners(){this.container&&(this.listeners=!1,this.container.addEventListener(O.DOM_EVENT_KEYDOWN,this.onKeyDown),this.container.addEventListener(O.DOM_EVENT_KEYUP,this.onKeyUp))}onKeyDown(t){let e=O.instance;e.dispatch(new m(m.APPLICATION_KEYBOARD_KEYDOWN,e.getSourceKeyboardEventVO(t)))}onKeyUp(t){let e=O.instance;e.dispatch(new m(m.APPLICATION_KEYBOARD_KEYUP,e.getSourceKeyboardEventVO(t)))}dispatch(t){this.target&&this.target.dispatchEvent(t)}getSourceKeyboardEventVO(t){return new y(t)}}class _{constructor(t){this.event={},this.parse(t)}parse(t){t||(t={}),this.event=t,this.type=t.type||this.type,this.isTrusted=t.isTrusted||this.isTrusted}}class C extends v{static get WINDOW_EVENT_RESIZE(){return\"resize\"}constructor(t,e=null){super(t,e),this.init()}get container(){return this.application.container}get width(){return this.sourceResizeEventVO.width}get height(){return this.sourceResizeEventVO.height}init(){C.instance=this,this.initListeners(),this.resize(),this.target=this.application,this.inited=!0}initListeners(){this.removeListeners(),this.addListeners()}addListeners(){this.container&&!this.listeners&&(this.listeners=!0,window.addEventListener(C.WINDOW_EVENT_RESIZE,this.onResize))}removeListeners(){this.container&&(this.listeners=!1,window.addEventListener(C.WINDOW_EVENT_RESIZE,this.onResize))}onResize(t){C.instance.resize(t)}resize(t=null){this.sourceResizeEventVO=this.getSourceResizeEventVO(t),this.sourceResizeEventVO.width=this.container.clientWidth,this.sourceResizeEventVO.height=this.container.clientHeight,this.dispatch(new m(m.APPLICATION_RESIZE,this.sourceResizeEventVO))}dispatch(t){this.target&&this.target.dispatchEvent(t)}getSourceResizeEventVO(t=null){let e=new _(t);return e.width=this.container.clientWidth,e.height=this.container.clientHeight,e}}class L{constructor(t){this.parse(t)}parse(t){t&&(this.event=t,this.type=t.type)}}class I extends v{static get DOM_EVENT_FOCUS(){return\"focus\"}static get DOM_EVENT_BLUR(){return\"blur\"}constructor(t,e=null){super(t,e),this.init()}get container(){return this.application.container}init(){this.initListeners(),I.instance=this,this.target=this.application,this.inited=!0}initListeners(){this.removeListeners(),this.addListeners()}addListeners(){this.container&&!this.listeners&&(this.listeners=!0,this.container.onfocus=this.onFocus,this.container.onblur=this.onBlur)}removeListeners(){this.container&&(this.listeners=!1,this.container.onfocus=null,this.container.onblur=null)}onFocus(t){let e=I.instance;e.dispatch(new m(m.APPLICATION_FOCUS,e.getSourceFocusEventVO(t)))}onBlur(t){let e=I.instance;e.dispatch(new m(m.APPLICATION_BLUR,e.getSourceFocusEventVO(t)))}dispatch(t){this.target&&this.target.dispatchEvent(t)}getSourceFocusEventVO(t){return new L(t)}}class A{constructor(t){this.event={},this.parse(t)}parse(t){t||(t={}),this.event=t,this.acceleration=t.acceleration,this.accelerationIncludingGravity=t.accelerationIncludingGravity,this.rotationRate=t.rotationRate}}class P extends v{constructor(t,e=null){super(t,e),this.absolute=0,this.alpha=0,this.beta=0,this.gamma=0,this.init()}static get DEVICEORIENTATIONCHANGE(){return\"orientationchange\"}static get DEVICEORIENTATION(){return\"deviceorientation\"}static get DEVICEMOTION(){return\"devicemotion\"}init(){P.instance=this,this.initListeners(),this.target=this.application,this.inited=!0}initListeners(){window.addEventListener(P.DEVICEORIENTATIONCHANGE,this.onOrientationChange),window.addEventListener(P.DEVICEORIENTATION,this.onOrientation),window.addEventListener(P.DEVICEMOTION,this.onMotion)}onOrientationChange(t){let e=P.instance;e.dispatch(new m(m.APPLICATION_DEVICE_ORIENTATION_CHANGE,e.sourceOrientationEventVO(t)))}onOrientation(t){let e=P.instance;e.absolute=t.absolute,e.alpha=t.alpha,e.beta=t.beta,e.gamma=t.gamma,e.dispatch(new m(m.APPLICATION_DEVICE_ORIENTATION,e.sourceOrientationEventVO(t)))}onMotion(t){let e=P.instance;e.acceleration=t.acceleration,e.accelerationIncludingGravity=t.accelerationIncludingGravity,e.rotationRate=t.rotationRate,e.dispatch(new m(m.APPLICATION_DEVICE_MOTION,e.sourceOrientationEventVO(t)))}dispatch(t){this.target&&this.target.dispatchEvent(t)}sourceOrientationEventVO(t=null){return new A(t)}}class N{constructor(t=null){this.KeyboardController={},this.ResizeController={},this.OrientationController={},this.FocusController={},this.DeviceController={},this.controllerList=[],this.parse(t)}parse(t){t||(t={}),this.data=t,this.KeyboardController=this.data.KeyboardController||this.KeyboardController,this.ResizeController=this.data.ResizeController||this.ResizeController,this.OrientationController=this.data.OrientationController||this.OrientationController,this.FocusController=this.data.FocusController||this.FocusController,this.DeviceController=this.data.DeviceController||this.DeviceController,this.controllerList=this.getControllerList(t.controllerList)}getControllerList(t){let e;return e=t&&0!=this.controllerList.length?t:N.controllerListDefault}}N.controllerListDefault=[O,C,I,P,class extends v{constructor(t,e=null){super(t,e)}get isMobile(){return!!(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i))}}];class T extends s{constructor(t,e=null){super(),this._list=[],this.application=t,this.initControllersVO(e),this.init()}get enable(){return this._enable}set enable(t){this._enable=t}get inited(){return this._inited}set inited(t){this._inited=t}get application(){return this._application}set application(t){this._application=t}get vo(){return this._vo}get controllerList(){return this.vo.controllerList}init(){this.inited=!0,this.addControllers(this.controllerList)}initControllersVO(t){this._vo=t||new N}addControllers(t){for(let t of this.controllerList){let e=new t(this.application,this.getOptionsForController(t.name));this._list.push(e)}}getOptionsForController(t){return this.vo[t]?this.vo[t]:this.vo.data[t]}}class D extends s{constructor(t){super(),this.controllerOptions=null,D.application=this,this.initContainer(t)}get inited(){return this._inited}get started(){return this._started}set started(t){this._started=t}get container(){return this._container}initContainer(t){this._container=t}init(){this.modules=new g,this.controllers=new T(this,this.controllerOptions)}}class S{constructor(){}static log(...t){if(!t||0==t.length)return void console.log(t);document.getElementById(\"text_for_log\").innerHTML+=\"<br>\"+t.toString(),1!=t.length?console.log(t):console.log(t[0])}}!function(t){t[t.NONE=0]=\"NONE\",t[t.FREE=1]=\"FREE\",t[t.WORKING=2]=\"WORKING\",t[t.ERROR=3]=\"ERROR\"}(d||(d={}));class R extends r{constructor(t,e){super(t,!1,!1),this.service=e}}R.ACTIVE=\"serviceActive\",R.DEACTIVE=\"serviceDeactive\",R.WORKING=\"serviceWorking\",R.COMPLETE=\"serviceComplete\",R.WAIT=\"serviceWait\";class f extends s{constructor(t){super(),this.sourceVO=null,this.activityState=!0,this.sourceVO=t}get inited(){return this._inited}get ID(){return this._ID}get name(){return this._name}get description(){return this._description}get state(){return this._state}set state(t){this._state=t}get enable(){return this._enable}set enable(t){this._enable=t}get working(){return this.state==d.WORKING}get isSupport(){return!0}init(){this.activity(!0),this.state=d.FREE}destroy(){this.activity(!1)}activity(t){if(t==this.activityState)return;this.activityState=t;let e=new R(this.activityState?R.ACTIVE:R.DEACTIVE,this);this.dispatchEvent(e)}}class M{constructor(t){this.volume=1,this.channels=[],this.mute=!1,this.progressCustom=!0,this.progressTimeout=1e3,this.data={},this.parse(t)}parse(t){t||(t={}),Object.assign(this.data,t),this.volume=this.data.volume||this.volume,this.channels=this.data.channels||this.channels}}class w extends r{static get VOLUME(){return\"audioChannelVolume\"}static get MUTE(){return\"audioChannelMute\"}constructor(t,e=null){super(t,!1,!1),this.channel=e}}class b extends s{constructor(t,e=1){super(),this._name=\"audioChannelName\",this._volume=1,this.audioWrapperList=[],this._name=t,this.volume=e}get name(){return this._name}get volume(){return this._volume}set volume(t){t<0&&(t=0),t>1&&(t=1),this._volume=t,this.dispatchEvent(new w(w.VOLUME,this))}get mute(){return this._mute||this._globalMute}set mute(t){this._mute=t,this.dispatchEvent(new w(w.MUTE,this))}globalMuteSet(t=!1){this._globalMute=t}volumeChange(){}}class V{constructor(t=null){this.volume=1,this.pan=0,this.loop=!1,this.playtimes=1,this.src=null,this.channel=null,this.autodestroy=!0,this.fadetime=500,this.pauseback=1e3,this.progressMethod=null,this.endedMethod=null,this.data={},this.parse(t)}parse(t){t||(t={}),Object.assign(this.data,t),this.volume=this.data.hasOwnProperty(\"volume\")?this.data.volume:this.volume,this.pan=this.data.hasOwnProperty(\"pan\")?this.data.pan:this.pan,this.loop=this.data.loop,this.playtimes=this.data.playtimes||this.playtimes,this.src=this.data.src||this.src,this.channel=this.data.channel||this.channel,this.autodestroy=this.data.autodestroy||this.autodestroy,this.fadetime=this.data.fadetime||this.fadetime,this.pauseback=this.data.pauseback||this.pauseback,this.progressMethod=this.data.progressMethod||this.progressMethod,this.endedMethod=this.data.endedMethod||this.endedMethod}}class G extends r{static get METADATA(){return\"audioMetaData\"}static get PLAY(){return\"audioPlay\"}static get PLAYING(){return\"audioPlaying\"}static get PAUSE(){return\"audioPause\"}static get CAN_PLAY(){return\"audioCanPlay\"}static get CAN_PLAY_THROUGH(){return\"audioCanPlayThrough\"}static get PROGRESS(){return\"audioProgress\"}static get DURATION_CHANGE(){return\"audioDurationChange\"}static get TIME_CHANGE(){return\"audioTimeChange\"}static get ENDED(){return\"audioEnded\"}static get LOOP(){return\"audioLoop\"}constructor(t,e=null){super(t,!1,!1),this.audioWrapper=e}}!function(t){t[t.NONE=0]=\"NONE\",t[t.WAIT=1]=\"WAIT\",t[t.PLAYING=2]=\"PLAYING\",t[t.PLAY=3]=\"PLAY\",t[t.PAUSING=4]=\"PAUSING\",t[t.PAUSE=5]=\"PAUSE\",t[t.STOPPING=6]=\"STOPPING\",t[t.STOP=7]=\"STOP\"}(l||(l={}));class Y{static now(){return Date.now()}}class U extends s{constructor(t){super(),this._globalMute=!1,this._state=l.WAIT,this.name=\"\",this.link=\"\",this.fadeStoppingInterval=0,this.fadeStoppingTime=0,this.pauseTime=0,this.init(t)}get audio(){return this._audio||(this._audio=new Audio),this._audio}get muted(){return this.audio.muted}set muted(t){this.audio.muted=t}get time(){return this.audio.currentTime}set time(t){this.audio.currentTime=t,this.dispatchEvent(new G(G.TIME_CHANGE,this))}get playtimes(){return this.vo.playtimes}set playtimes(t){this.vo.playtimes=t}get volume(){return this.vo.volume}set volume(t){t<0&&(t=0),t>1&&(t=1),this.vo.volume!=t&&(this.vo.volume=t,this.volumeChange())}get mute(){return this.audio.muted}set mute(t){this.audio.muted=t}get src(){return this.audio?this.audio.src:\"\"}set src(t){t&&(this.vo.src=t,this.initAudio())}get duration(){return this.audio.duration}get progress(){return this.time/this.duration}get channel(){return this.vo.channel}get playing(){return!this.audio.paused}get state(){return this._state}init(t){this.initVO(t),this.initAudio();let e=this.audio;e.addEventListener(\"loadedmetadata\",t=>{this.onLoadedMetaData()}),e.addEventListener(\"canplay\",t=>{this.onCanPlay()}),e.addEventListener(\"canplaythrough\",t=>{this.onCanPlayThrough()}),e.addEventListener(\"play\",t=>{this.onPlay()}),e.addEventListener(\"playing\",t=>{this.onPlaying()}),e.addEventListener(\"pause\",t=>{this.onPause()}),e.addEventListener(\"progress\",t=>{this.onProgress()}),e.addEventListener(\"durationchange\",t=>{this.onDurationChange()}),e.addEventListener(\"ended\",t=>{this.onEnded()})}initVO(t){t||(t=new V),this.vo=t}initAudio(){this.stop(!0),this.srcChange(),this.volumeChange()}onLoadedMetaData(){this.dispatchEvent(new G(G.METADATA,this))}onCanPlay(){this.dispatchEvent(new G(G.CAN_PLAY,this))}onCanPlayThrough(){this.dispatchEvent(new G(G.CAN_PLAY_THROUGH,this))}onPlay(){this.dispatchEvent(new G(G.PLAY,this))}onPlaying(){this.dispatchEvent(new G(G.PLAYING,this))}onPause(){this.dispatchEvent(new G(G.PAUSE,this))}onProgress(){}onDurationChange(){this.dispatchEvent(new G(G.DURATION_CHANGE,this))}onEnded(){this.dispatchEvent(new G(G.ENDED,this)),this.audioEnded()}update(){this.playing&&this.dispatchEvent(new G(G.PROGRESS,this))}volumeUpdate(){this.volume=this.channel.volume*this.volume}volumeChange(){this.audio.volume!=this.vo.volume&&(this.audio.volume=this.volume)}globalMuteSet(t=!1){this._globalMute=t}muteUpdate(){this.mute=this._globalMute||this.channel.mute||this.audio.muted}srcChange(){this.audio.src!=this.vo.src&&(this.audio.src=this.vo.src)}setState(t){this._state=t}fadingKillTimeout(){clearInterval(this.fadeStoppingInterval),this.fadeStoppingInterval=0}fadingCreateInterval(){this.fadeStoppingInterval||(this.fadeStoppingInterval=setInterval(()=>{this.fadingTick()},20))}fadingTick(){let t=(Y.now()-this.fadeStoppingTime)/this.vo.fadetime;switch(t>1&&(t=1),this.state){case l.STOPPING:case l.PAUSING:this.audioSteppingVolume(1-t);break;case l.PLAY:case l.PLAYING:this.audioSteppingVolume(t)}1==t&&this.fadingStop()}fadingStart(t=l.NONE){let e=this.vo.fadetime>0,i=this.state==l.PLAYING||this.state==l.PLAY,s=this.state==l.STOP||this.state==l.STOPPING||this.state==l.PAUSE||this.state==l.PAUSING;this.setState(t),(i||s)&&(e?(this.fadeStoppingTime=Y.now(),this.fadingCreateInterval()):this.fadingStop())}fadingStop(){switch(this.fadingCreateInterval(),this.state){case l.STOPPING:this.setState(l.STOP),this.audioSteppingVolume(0),this.audioStop();break;case l.PAUSING:this.setState(l.PAUSE),this.audioSteppingVolume(0),this.audioPause();break;case l.PLAY:case l.PLAYING:this.setState(l.PLAY),this.audioSteppingVolume(1)}}audioSetPauseTime(){this.pauseTime=this.audio.currentTime-.001*this.vo.pauseback,this.pauseTime<0&&(this.pauseTime=0),this.audio.currentTime=this.pauseTime}audioResetPauseTime(){this.pauseTime=0,this.audio.currentTime=this.pauseTime}audioPlay(){this.audio.play()}audioPause(){this.audioSetPauseTime(),this.audio.pause()}audioStop(){this.audioPause(),this.audioResetPauseTime(),this.setState(l.WAIT)}audioSteppingVolume(t=1){this.audio.volume=this.volume*t}audioEnded(){this.state==l.PLAY&&(this.stop(!0),this.vo.loop?(this.dispatchEvent(new G(G.LOOP,this)),this.play()):this.vo.playtimes>0&&(this.vo.playtimes--,this.dispatchEvent(new G(G.LOOP,this)),this.play()))}play(){this.state!=l.PLAY&&this.state!=l.PLAYING&&(this.volumeChange(),this.audioPlay(),this.fadingStart(l.PLAY))}stop(t=!1){t?(this.fadingStop(),this.audioStop()):this.fadingStart(l.STOPPING)}pause(){this.audio.paused?(this.volumeChange(),this.audioPlay(),this.fadingStart(l.PLAY)):this.fadingStart(l.PAUSING)}}class W extends f{constructor(t){super(t),this._channels=[],this._audioWrapperList=[],this.audioWrapperTimerIndex=0,this.init()}static get instance(){return W.instance||(W._instance=new W(new M({}))),W._instance}get vo(){return this.sourceVO}get channels(){return this._channels}get volume(){return this.vo.volume}set volume(t){t<0&&(t=0),t>1&&(t=1),this.vo.volume!=t&&(this.vo.volume=t,this.volumeChange())}get mute(){return this.vo.mute}set mute(t){this.vo.mute!=t&&(this.vo.mute=t,this.channelChangeMute())}init(){this.initChannels()}initChannels(){for(let t of this.vo.channels)this.channelAddByName(t)}channelAddByName(t,e=1){let i;return t?((i=this.channelGetByName(t))||(i=this.channelCreate(t,e),this._channels.push(i)),i):null}channelGetByName(t){for(let e of this._channels)if(e.name==t)return e;return null}channelGetChannelByIndex(t=0){return t>-1&&this._channels.length>t?this._channels[t]:null}channelCreate(t,e=1){if(!t)return null;let i=new b(t,e);return i.addEventListener(w.VOLUME,this.onAudioChannelVolume),i.addEventListener(w.MUTE,this.onAudioChannelMute),i}channelGetByNameOrCreate(t=null){let e=this.channelAddByName(t);return e||(e=this.channelAddByName(W.AUDIO_CHANNEL_NAME_DEFAULT,W.AUDIO_CHANNEL_VOLUME_DEFAULT))}onAudioChannelVolume(t){this.audioWrapperVolumeChange()}onAudioChannelMute(t){this.muteChange()}volumeChange(){this.channelVolumeChange()}channelVolumeChange(){for(let t of this.channels)t.volume=t.volume*this.vo.volume}audioWrapperVolumeChange(){for(let t of this._audioWrapperList)t.volumeUpdate()}muteChange(){for(let t of this._audioWrapperList)t.globalMuteSet(this.mute)}channelChangeMute(){for(let t of this.channels)t.globalMuteSet(this.mute)}audioWrapperGet(t){let e=new U(t);return this._audioWrapperList.push(e),e}audioWrappersListenerUpdate(){!this.vo.progressCustom||this.vo.progressTimeout<=0||(this.isAudioWrapperActive()?this.audioWrapperTimerStart():this.audioWrapperTimerStop())}isAudioWrapperActive(){for(let t of this._audioWrapperList)if(t.playing)return!0;return!1}audioWrapperTimerStart(){this.audioWrapperTimerIndex||(this.audioWrapperTimerIndex=setInterval(()=>{this.audioWrapperInterval()},this.vo.progressTimeout))}audioWrapperTimerStop(){clearInterval(this.audioWrapperTimerIndex)}audioWrapperInterval(){for(let t of this._audioWrapperList)t.playing&&t.update()}audioWrapperVOGetNew(t,e,i=1,s=0,n=!1,r=-1){return new V({src:t,channel:e,volume:i,pan:s,loop:n,playtimes:r})}play(t){if(!t)return null;let e,i,s;return t instanceof V?(i=t).channel||(i.channel=this.channelGetByNameOrCreate(null)):\"string\"==typeof t&&(e=this.channelGetByNameOrCreate(null),i=this.audioWrapperVOGetNew(t,e,this.volume)),i?((s=this.audioWrapperGet(i)).play(),this.audioWrappersListenerUpdate(),s):void 0}}W.AUDIO_CHANNEL_NAME_DEFAULT=\"main\",W.AUDIO_CHANNEL_VOLUME_DEFAULT=1;try{new class extends D{constructor(t){super(t),S.log(\"Started: MAIN\"),this.addEventListener(m.APPLICATION_KEYBOARD_KEYDOWN,t=>{S.log(t),\"q\"==t.data.key&&(s.volume+=.05),\"a\"==t.data.key&&(s.volume-=.05),\"w\"==t.data.key&&s.pause(),\"s\"==t.data.key&&e.play(\"homely_loop.mp3\")}),this.addEventListener(m.APPLICATION_KEYBOARD_KEYUP,t=>{S.log(t)}),this.addEventListener(m.APPLICATION_RESIZE,t=>{S.log(t)}),this.addEventListener(m.APPLICATION_FOCUS,t=>{S.log(t)}),this.addEventListener(m.APPLICATION_BLUR,t=>{S.log(t)}),this.addEventListener(m.APPLICATION_DEVICE_MOTION,t=>{S.log(t)}),this.addEventListener(m.APPLICATION_DEVICE_ORIENTATION,t=>{S.log(t)}),this.addEventListener(m.APPLICATION_DEVICE_ORIENTATION_CHANGE,t=>{S.log(t)});let e=new W(new M({})),i=new V({src:\"homely_loop.mp3\",volume:0,loop:!0}),s=e.play(i);s.addEventListener(G.PLAY,t=>{S.log(t)}),s.addEventListener(G.PAUSE,t=>{S.log(t)}),s.addEventListener(G.LOOP,t=>{S.log(t)});const n=new WebSocket(\"ws://google.com\");n.onopen=function(){S.log(\"Соединение установлено.\"),n.send(\"ping\")},n.onclose=function(t){t.wasClean?S.log(\"Соединение закрыто чисто\"):S.log(\"Обрыв соединения\"),S.log(\"Код: \"+t.code+\" причина: \"+t.reason)},n.onmessage=function(t){S.log(\"Получены данные\"),S.log(t.data)},n.onerror=function(t){S.log(\"Ошибка\"),S.log(t.message)}}}(frame).init()}catch(t){}}]);","extractedComments":[]}